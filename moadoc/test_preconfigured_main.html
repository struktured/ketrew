<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="http://cdn.jsdelivr.net/bootstrap/3.1.1/css/bootstrap.min.css" type="text/css">
  <link rel="stylesheet" href="http://cdn.jsdelivr.net/bootstrap/3.1.1/css/bootstrap-theme.min.css" type="text/css">
  <link rel="stylesheet" href="code_style.css" type="text/css">
  <meta charset="utf-8">
  <title>Ketrew: test preconfigured main</title>
</head>
  <body><div class="container">
  <h1>Ketrew: test preconfigured main</h1>
  <h2>Contents</h2>
<pre class='ocaml'><code class='ocaml'><span class="text">
</span></code></pre>
<h2 id="CreateTheConfiguration">Create The Configuration</h2>
<p>Overriding the configuration from a main file:</p>
<pre class='ocaml'><code class='ocaml'><span class="kw">let</span><span class="text"> </span><span class="id">override_configuration</span><span class="text"> =
  </span><span class="kw">let</span><span class="text"> </span><span class="kw">open</span><span class="text"> </span><span class="kw2">Ketrew_configuration</span><span class="text"> </span><span class="kw">in</span><span class="text">
  </span><span class="kw">let</span><span class="text"> </span><span class="id">server</span><span class="text"> =
    </span><span class="id">create_server</span><span class="text"> </span><span class="kw4">~authorized_tokens_path</span><span class="text">:</span><span class="string">&quot;/tmp/tokens&quot;</span><span class="text">
      </span><span class="kw4">~return_error_messages</span><span class="text">:</span><span class="constant">false</span><span class="text">
      ?</span><span class="id">command_pipe</span><span class="text">:</span><span class="kw2">None</span><span class="text">
      (`</span><span class="kw2">Tls</span><span class="text"> (</span><span class="string">&quot;somecert.pem&quot;</span><span class="text">, </span><span class="string">&quot;somekey.pem&quot;</span><span class="text">, </span><span class="numeric">4242</span><span class="text">))
  </span><span class="kw">in</span><span class="text">
  </span><span class="id">create</span><span class="text">
    </span><span class="kw4">~debug_level</span><span class="text">:</span><span class="numeric">42</span><span class="text">
    </span><span class="kw4">~with_color</span><span class="text">:</span><span class="constant">true</span><span class="text">
    </span><span class="kw4">~database_parameters</span><span class="text">:</span><span class="string">&quot;/tmp/somepath&quot;</span><span class="text">
    </span><span class="kw4">~plugins</span><span class="text">:[`</span><span class="kw2">OCamlfind</span><span class="text"> </span><span class="string">&quot;lwt.react&quot;</span><span class="text">; `</span><span class="kw2">OCamlfind</span><span class="text"> </span><span class="string">&quot;lwt.unix&quot;</span><span class="text"> ]
    </span><span class="kw4">~server</span><span class="text"> ()

</span></code></pre>
<h2 id="StartTheApplication">Start The Application</h2>
<p>Calling <code>Ketrew.Command_line.run_main</code>
just like <code>src/app/main.ml</code> but preconfigured:</p>
<pre class='ocaml'><code class='ocaml'><span class="kw">let</span><span class="text"> `</span><span class="kw2">Never_returns</span><span class="text"> =
  </span><span class="kw2">Ketrew</span><span class="text">.</span><span class="kw2">Command_line</span><span class="text">.</span><span class="id">run_main</span><span class="text"> </span><span class="kw4">~override_configuration</span><span class="text"> ()</span></code></pre>
</div></body><html>
